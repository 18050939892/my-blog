import{j as e}from"./jsx-runtime.D_zvdyIk.js";import{r as o}from"./index.BVOCwoKb.js";const b=[{author:"小老杜",text:"产生的v测试",date:"2025-04-29T07:11:24.668Z"},{author:"从v从",text:"发生的v",date:"2025-04-29T07:13:02.713Z"},{author:"Sat Naing",text:"啊啊啊",date:"2025-04-29T07:14:28.577Z"},{author:"jojoba",text:"发的是多少",articleTitle:"Csgo",date:"2025-04-29T07:44:45.158Z"},{author:"小老杜",text:"地方v感到十分v",articleTitle:"Lssssss",date:"2025-04-29T07:50:08.415Z"}],g={comments:b};function j({articleTitle:n}){const u=g.comments.filter(t=>t.articleTitle===n),[d]=o.useState(u||[]),[s,l]=o.useState({author:"",text:"",articleTitle:n}),[m,i]=o.useState(!1),[c,a]=o.useState(""),h=async t=>{if(t.preventDefault(),!s.author.trim()||!s.text.trim()){a("请填写昵称和评论内容");return}i(!0);try{const x=await(await fetch("/api/comments",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(s)})).json();x.success?(a("评论已提交，审核后将显示"),l({...s,author:"",text:""})):a(`提交失败: ${x.message}`)}catch(r){console.error("提交评论时出错:",r),a("提交评论时发生错误，请稍后再试")}finally{i(!1)}};return e.jsxs("section",{className:"comment-section my-8",children:[e.jsx("h2",{className:"text-2xl font-bold mb-4",children:"评论"}),d.length>0?e.jsx("div",{className:"space-y-4 mb-6",children:d.map((t,r)=>e.jsxs("div",{className:"bg-gray-100 dark:bg-gray-800 p-4 rounded-lg",children:[e.jsxs("div",{className:"flex items-center mb-2 text-sm text-gray-600 dark:text-gray-400",children:[e.jsx("span",{className:"font-semibold",children:t.author}),e.jsx("span",{className:"mx-2",children:"•"}),e.jsx("time",{children:new Date(t.date).toLocaleDateString()})]}),e.jsx("p",{className:"text-gray-800 dark:text-gray-200",children:t.text})]},r))}):e.jsx("p",{className:"text-gray-600 dark:text-gray-400 mb-4",children:"还没有评论。成为第一个评论的人吧！"}),e.jsxs("form",{onSubmit:h,className:"space-y-4 mt-6",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"author",className:"block text-sm font-medium mb-1",children:"昵称"}),e.jsx("input",{type:"text",id:"author",value:s.author,onChange:t=>l({...s,author:t.target.value}),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-700 rounded-md dark:bg-gray-800",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"text",className:"block text-sm font-medium mb-1",children:"评论"}),e.jsx("textarea",{id:"text",value:s.text,onChange:t=>l({...s,text:t.target.value}),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-700 rounded-md h-32 dark:bg-gray-800",required:!0})]}),c&&e.jsx("div",{className:"text-sm py-2 px-3 rounded-md bg-blue-50 dark:bg-blue-900 text-blue-800 dark:text-blue-200",children:c}),e.jsx("button",{type:"submit",disabled:m,className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 disabled:opacity-50",children:m?"提交中...":"发表评论"})]})]})}export{j as default};
